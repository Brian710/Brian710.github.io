var onEnableiframe="",onEnableroll="",pano="",roll=["roll_a_1","roll_a_2","roll_a_3","roll_a_4","roll_a_5","roll_a_6","roll_a_7","roll_a_8","roll_a_9","roll_a_10","roll_a_11","roll_a_12","roll_a_13","roll_a_14","roll_a_15","roll_a_16"];function AppendLogoImage(){let e=document.createElement("IMG");e.setAttribute("class","Logo"),e.setAttribute("id","TMBALogo"),e.addEventListener("click",()=>{window.open("https://www.tmba.org.tw/")}),pano.appendChild(e)}function SetSpotInit(e){e!=document.getElementById("Content").getAttribute("data")?pano.call("do_animation("+e+", 3000)"):pano.call("do_animation("+e+", 100)")}function SetEnableFrame(e){e!=onEnableiframe&&SetDisableFrame(),onEnableiframe=e,document.getElementById("Content").setAttribute("data",onEnableiframe),pano.call("set(hotspot["+e+"].url, '%FIRSTXML%/add_hotspot/picture/clickNow.png')")}function SetEnableFrame_Other(e){e!=onEnableiframe&&SetDisableFrame(),onEnableiframe="",document.getElementById("Content").setAttribute("data",e)}function SetDisableFrame(){document.getElementById("Content").setAttribute("data",""),pano.call("set(hotspot["+onEnableiframe+"].url, '%FIRSTXML%/add_hotspot/picture/Plus_Btn.png')"),onEnableiframe=""}function SetRollingPaperImage(e){e!=onEnableroll&&""!=onEnableroll&&pano.call("open_or_close_door("+onEnableroll+"); open_or_close_door(door_hitarea_a_1);"),e!=onEnableroll?""!=onEnableroll?setTimeout(()=>{ChangeRollPaper(e),pano.call("open_or_close_door(door_hitarea_a_1);"),onEnableroll=e},1e3):(ChangeRollPaper(e),pano.call("open_or_close_door(door_hitarea_a_1);"),onEnableroll=e):(ChangeRollPaper(e),pano.call("open_or_close_door(door_hitarea_a_1);"),onEnableroll="")}function SetEnableFrame_Wall(e){document.getElementById("Content").setAttribute("data",e)}function SetTimerChangeContent(e){""!=document.getElementById("Content").getAttribute("data-ar")&&null!=document.getElementById("Content").getAttribute("data-ar")?"UB660"==document.getElementById("Content").getAttribute("data-ar")?(document.getElementById("Content").setAttribute("data-ar","VTL1600A"),pano.call("set(hotspot["+e+"].url, %FIRSTXML%/add_hotspot/picture/VTL1600A.png)")):(document.getElementById("Content").setAttribute("data-ar","UB660"),pano.call("set(hotspot["+e+"].url, %FIRSTXML%/add_hotspot/picture/UB-660.png)")):document.getElementById("Content").setAttribute("data-ar","UB660"),setTimeout(function(){SetTimerChangeContent(e)},5e3)}function ChangeRollPaper(o){if(o!=onEnableroll)for(let e=0;e<roll.length;e++)"door_hitarea11"==o?e<10?pano.call("set(hotspot["+roll[e]+"].url, 'images/rollingpaper/Q1/Q1_0"+e+".png')"):pano.call("set(hotspot["+roll[e]+"].url, 'images/rollingpaper/Q1/Q1_"+e+".png')"):"door_hitarea12"==o?e<10?pano.call("set(hotspot["+roll[e]+"].url, 'images/rollingpaper/Q2/Q2_0"+e+".png')"):pano.call("set(hotspot["+roll[e]+"].url, 'images/rollingpaper/Q2/Q2_"+e+".png')"):"door_hitarea13"==o?e<10?pano.call("set(hotspot["+roll[e]+"].url, 'images/rollingpaper/Q3/Q3_0"+e+".png')"):pano.call("set(hotspot["+roll[e]+"].url, 'images/rollingpaper/Q3/Q3_"+e+".png')"):"door_hitarea14"==o?e<10?pano.call("set(hotspot["+roll[e]+"].url, 'images/rollingpaper/Q4/Q4_0"+e+".png')"):pano.call("set(hotspot["+roll[e]+"].url, 'images/rollingpaper/Q4/Q4_"+e+".png')"):"door_hitarea15"==o&&(e<10?pano.call("set(hotspot["+roll[e]+"].url, 'images/rollingpaper/Q5/Q5_0"+e+".png')"):pano.call("set(hotspot["+roll[e]+"].url, 'images/rollingpaper/Q5/Q5_"+e+".png')"))}function ChangeSceneCloseFrame(){pano.call("set(visible,false);tween(layer[IFRAME_HTML].oy, -350);tween(layer[IFRAME_HTML].alpha, 0);tween(layer[freim_bg_Adhs].alpha, 0);set(layer[fon_zad_plan_adhs].enabled, false);tween(layer[fon_zad_plan_adhs].alpha, 0);delayedcall(0.3,removelayer(IFRAME_HTML);removelayer(freim_bg_Adhs);"),SetDisableFrame(),onEnableroll=""}function DisplayLogo(e){"true"==e?document.getElementById("TMBALogo").style.display="":"false"==e&&(document.getElementById("TMBALogo").style.display="none")}window.onload=function(){embedpano({swf:"tour.swf",xml:"tour.xml",target:"pano",html5:"auto",mobilescale:1,passQueryParameters:!0}),pano=parent.window.document.getElementById("krpanoSWFObject"),AppendLogoImage(),SetTimerChangeContent("hotspot_94")};